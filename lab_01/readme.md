# Лабораторная работа №1. "Длинная арифметика"

**Студент** Ларин Владимир - ИУ7-34Б

## Описание условия задачи

Смоделировать операцию деления целого числа длиной до 30 десятичных цифр на
действительное число в форме ±m.n Е ±K, где суммарная длина мантиссы (m+n) - до
30 значащих цифр, а величина порядка K -до 5 цифр. Результат выдать в форме
±0.m1 Е ±K1, где m1 - до 30 значащих цифр, а K1 -до 5 цифр.

## Техническое задание

### Входные данные:

1.  **Делимое:** строка, содержащая целое число в виде `[+/-]m`, где `m` - до 30
    цифр. Наличие знака перед числом не обязательно.

2.  **Делитель**: строка, содержащая вещественное число в виде
    `[+/-]m[.n][[e/E][+/-]K]`. Суммарная длина мантиссы (m+n) – до 30 цифры (не
    считая точку), порядка `K` – до 5 цифр. Наличие точки, знака порядка и знака
    числа, знака экспоненты не обязательно.

### Выходные данные:

1.  **Результат деления** - длинное число, нормализованное в виде `[-]0.Me[-]K`,
    где длина `M` – 30 цифр, `K` – до 5 цифр.

**Функция программы:** деление целого числа на действительное.

**Обращение к программе:** запускается из терминала.

### Аварийные ситуации:

1.  Некорректный ввод строки с целым числом. На входе: строка, не
    удовлетворяющая условию записи целового числа, указанного в ТЗ. На выходе:
    сообщение об ошибке ввода

2.  Некорректный ввод строки с вещественным числом. На входе: строка, не
    удовлетворяющая условию записи вещественного числа, указанного в ТЗ. На
    выходе: сообщение об ошибке ввода

3.  Переполнение порядка. На входе: в процессе деления степень полученного числа
    превышает 99999 по модулю. На выходе: сообщение о переполнении разряда

4.  Деление на ноль. На входе: вещественное число, равное 0. На выходе:
    сообщение о ошибке деления на ноль

## Структуры данных

Для хранения целового длинного числа используется структура `long_int_t`,
которая состоит из целочисленного массива размером 31 Байт и знака числа - 1
байт. Нулевой байт массива - есть ведущий ноль, для обнаружения переполнений при
выполнении операции суммирования.

```c
#define MANTIS_LENGTH 31

typedef struct 
{
    bool sign;
    int8_t digits[MANTIS_LENGTH];
} long_int_t;
```

Для хранение длинного вещественного числа используется структура `long_real_t`,
которая состоит из длиного целового `long_int_t`, который представляет собой
мантису, и порядка, представленный в виде целого 4-х байтного знакового числа.

```c
typedef struct 
{
    long_int_t mantis;
    int32_t exp;
} long_real_t;
```

## Алгоритм

1.  На вход программе подаётся строка , содержащая целое число - делимое.

2.  Программа преобразует поданную строку в структуру `long_int_t`, в результате
    обработки выявляются ошибки формата числа.

3.  Длинное число `long_int_t` преобразуется в вещественное длинное
    `long_real_t`;

4.  На вход программе подаётся строка, содержащая вещественное число - делитель.

5.  Программа преобразует поданную строку в структуру `long_real_t`, в
    результате обработки выявляются ошибки формата числа.

6.  Выполняется деление первого числа на второе методом “деления в столбик”, при
    этом контроллируется округление.

7.  Если результат деления корректен, то он выводится пользователю в
    нормализованном виде в соответствии со спецификацией, указанной в ТЗ.

8.  При успешном делении число выводится согласно спецификации, описанной в ТЗ.

## Тесты

| \# | Тип теста  | Описание теста                           | Делимое (целое)   | Делитель (вещественное) | Результат         |
|----|------------|------------------------------------------|-------------------|-------------------------|-------------------|
| 1  | Негативный | Ввод символов в делимом                  | s                 | \-                      | Ошибка            |
| 2  | Негативный | Ввод вещественного вместо целового       | 123.              | \-                      | Ошибка            |
| 3  | Негативный | Ввод вещественного с несколькими точками | 123               | 123.1.1                 | Ошибка            |
| 4  | Негативный | Ввод вещественного без указания порядка  | 123               | 123e                    | Ошибка            |
| 5  | Негативный | Ввод символов в делителе                 | 123               | x                       | Ошибка            |
| 6  | Негативный | Ввод точки в экспоненте                  | 123               | 123e12.4                | Ошибка            |
| 7  | Негативный | Ввод запредельной экспонеты              | 123               | 0.123e10000             | Ошибка            |
| 8  | Негативный | Ввод вещественного без указания мантисы  | 123               | e124                    | Ошибка            |
| 9  | Негативный | Ввод запредельного целового              | 99..99 (31 число) | \-                      | Ошибка            |
| 10 | Негативный | Ввод запредельной мантисы                | 1                 | 99..99 (31 число)       | Ошибка            |
| 11 | Негативный | Деление на ноль                          | 1                 | 0                       | Ошибка            |
| 12 | Негативный | Переполнение порядка                     | \+10000           | \+1Е-99999              | Ошибка            |
| 1  | Позитивный | Деление целых                            | 45                | 30                      | 0.15e1            |
| 2  | Позитивный | Деление целых                            | 20                | 40                      | 0.5e0             |
| 3  | Позитивный | Деление на дробное                       | 20                | 0.40                    | 0.5e2             |
| 4  | Позитивный | Округление                               | 2                 | 3                       | 0.666..7e0        |
| 5  | Позитивный | Округление                               | 100               | 35                      | 0.(285714) ..14e1 |
| 6  | Позитивный | Округление                               | 100               | 35                      | 0.(285714) ..14e1 |
| 7  | Позитивный | Округление                               | 99..99(30 знаков) | 2                       | 0.5e30            |
| 8  | Позитивный | Ввод делитель с ведущими нулями          | 0001              | 10                      | 0.1e0             |
| 9  | Позитивный | Ввод мантисы с ведущими нулями           | 1                 | 00.01                   | 0.1e3             |
| 10 | Позитивный | Ввод экспоненты с ведущими нулями        | 1                 | 1e0001                  | 0.1e0             |
| 11 | Позитивный | Деление нуля на число                    | 000               | 1000e9999               | 0                 |
| 12 | Позитивный | Предельный ввод целового                 | 99..99 (30 чисел) | 1                       | 0.99999e30        |
| 13 | Позитивный | Предельный ввод мантисы                  | 99..99 (30 чисел) | 99..99(30 чисел)e0      | 0.1e1             |
| 14 | Позитивный | Предельный ввод экспоненты               | 1                 | 1e99999                 | 0.1e-99998        |
| 15 | Позитивный | Предельный вывод экспоненты              | 1                 | 10e99999                | 0.1e-99999        |
| 16 | Позитивный | Деление положительного на положительное  | 1                 | 1                       | 0.1e1             |
| 17 | Позитивный | Деление положительного на отрицательное  | 1                 | \-1                     | \-0.1e1           |
| 18 | Позитивный | Деление отрицательного на положительное  | \-1               | 1                       | \-0.1e1           |
| 19 | Позитивный | Деление отрицательного на отрицательное  | \-1               | \-1                     | 0.1e1             |

## Контрольные вопросы

1.  **Каков возможный диапазон чисел, представляемых в ПК?**

Возможный диапазон чисел зависит от их типа, размера выделенной для их хранения
памяти, разрядности процессора. Для беззнакового целого числа выделяется 64
двоичных разряда, то есть его область значений – $`[0; 2^{64} - 1]`$ (`long long
unsigned int`).

2.  **Какова возможная точность представления чисел, чем она определяется?**

Точность представления вещественных чисел зависит от количества памяти,
выделенного для хранения мантиссы. Для мантиссы типа double выделяется 52 бита,
то есть мантисса может принимать значения до $`2^{52}`$ - это до 15 знаков.

3.  **Какие стандартные операции возможны над числами?**

Стандартные операции:
-   сравнение
-   сложение
-   вычитание
-   умножение
-   деление

4.  **Какой тип данных может выбрать программист, если обрабатываемые числа
    превышают возможный диапазон представления чисел в ПК?**

Программист может представить длинные числа в виде массива разрядов.

5.  **Как можно осуществить операции над числами, выходящими за рамки машинного
    представления?**

Можно применить сторонние библиотеки или применить собственные решения.
Например, представив длинные числа в виде массива разрядов.

## Вывод

Выполнил лабораторную работу. Познакомился с длинной арифметикой. Узнал, что
можно обрабатывать числа, выходящие за размерную сетку процессора с помощью
разбиение числа на разряды и их хранение в массиве чисел.
